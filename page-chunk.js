(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1679:function(e,s,a){Promise.resolve().then(a.bind(a,4977))},4977:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return m}});var t=a(7437),n=a(2265);function l(e){let{onManagePeople:s,onManageEvents:a,onSelectPeople:n,onProcessFiles:l,onBackup:r}=e;return(0,t.jsxs)("nav",{className:"nav-menu",children:[(0,t.jsx)("button",{onClick:n,children:"Select People"}),(0,t.jsx)("button",{onClick:s,children:"Manage People"}),(0,t.jsx)("button",{onClick:a,children:"Manage Events"}),(0,t.jsx)("button",{onClick:l,children:"Process New Files"}),(0,t.jsx)("button",{onClick:r,children:"Backup Database"})]})}function r(e){let{selectedPeople:s,selectedEvent:a,showNoPeople:l,sortOrder:r,exclusiveFilter:i,onSelectedPeopleChange:o,onSelectedEventChange:c,onShowNoPeopleChange:d,onSortOrderChange:h,onExclusiveFilterChange:m,onContinue:u}=e,[p,x]=(0,n.useState)([]),[j,g]=(0,n.useState)([]),[v,N]=(0,n.useState)(!0),[b,f]=(0,n.useState)(null),[y,w]=(0,n.useState)(!1),[C,S]=(0,n.useState)(0),[k,D]=(0,n.useState)(!1),[E,P]=(0,n.useState)(0);(0,n.useEffect)(()=>{y?N(!1):T()},[y]),(0,n.useEffect)(()=>{if(k&&E<12){let e=setTimeout(()=>{P(e=>e+1),T()},5e3);return()=>clearTimeout(e)}},[k,E]);let T=async()=>{try{k&&0!==E||N(!0),f(null);let e=new AbortController,s=setTimeout(()=>e.abort(),1e4),[a,t]=await Promise.all([fetch("/api/people",{signal:e.signal}),fetch("/api/events",{signal:e.signal})]);if(clearTimeout(s),!a.ok||!t.ok){let e=a.ok?t:a;a.ok;let s=await e.json().catch(()=>({error:"Unknown error"}));if(s.message,s.stack,s.debug,e.status>=502&&e.status<=504)throw D(!0),Error("Database is warming up...");throw Error(s.message||s.error||"Failed to fetch data from server")}let n=await a.json(),l=await t.json();x(n),g(l),w(!0),S(0),D(!1),P(0)}catch(e){e instanceof Error?"AbortError"===e.name?(D(!0),f("Database is warming up...")):e.message.includes("warming up")?(D(!0),f(e.message)):e.message.includes("Failed to fetch")?(D(!0),f("Database is warming up...")):f(e.message):f("An error occurred")}finally{N(!1)}},F=e=>{s.includes(e)?o(s.filter(s=>s!==e)):s.length<5&&o([...s,e])};return v&&k?(0,t.jsx)("div",{className:"loading-container",children:(0,t.jsxs)("div",{className:"loading-card",children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsx)("h2",{children:"Database is Warming Up"}),(0,t.jsx)("p",{className:"loading-message",children:"The Azure SQL database is starting up after being idle. This usually takes 10-30 seconds."}),(0,t.jsx)("div",{className:"progress-bar",children:(0,t.jsx)("div",{className:"progress-fill"})}),(0,t.jsxs)("p",{className:"loading-hint",children:["☕ Grab a coffee! We're checking every 5 seconds...",E>0&&" (Attempt ".concat(E+1,"/12)")]})]})}):v?(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("h1",{className:"text-center mb-2",children:"Select People to Browse"}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{style:{marginBottom:"0.5rem",display:"block"},children:"Loading people..."}),(0,t.jsxs)("div",{style:{height:"350px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsxs)("p",{style:{marginTop:"1rem",color:"#6c757d"},children:["Loading ",p.length>0?"".concat(p.length," people"):"data","..."]})]})]})]}):b&&!k?(0,t.jsx)("div",{className:"error-container",children:(0,t.jsxs)("div",{className:"error-card",children:[(0,t.jsx)("div",{className:"error-icon",children:"⚠️"}),(0,t.jsx)("h2",{children:"Unable to Load People List"}),(0,t.jsx)("p",{className:"error-message",children:b}),(0,t.jsxs)("div",{className:"error-hint",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"\uD83D\uDCA1 Tip:"})," Try clicking retry below."]}),(0,t.jsx)("p",{children:"If the issue persists, the database may need to warm up."})]}),(0,t.jsxs)("button",{className:"btn btn-primary mt-2",onClick:()=>{S(e=>e+1),D(!1),P(0),T()},children:["\uD83D\uDD04 Retry ",C>0&&"(Attempt ".concat(C+1,")")]})]})}):(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("h1",{className:"text-center mb-2",children:"Select People to Browse"}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{style:{marginBottom:"0.5rem",display:"block"},children:"Select People (up to 5):"}),(0,t.jsx)("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#fff"},children:(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.95rem"},children:[(0,t.jsx)("thead",{style:{position:"sticky",top:0,backgroundColor:"#f8f9fa",borderBottom:"2px solid #dee2e6"},children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{padding:"0.75rem 0.5rem",textAlign:"center",width:"40px"}}),(0,t.jsx)("th",{style:{padding:"0.75rem 0.5rem",textAlign:"left",fontWeight:"600"},children:"Name"}),(0,t.jsx)("th",{style:{padding:"0.75rem 0.5rem",textAlign:"left",fontWeight:"600"},children:"Description"}),(0,t.jsx)("th",{style:{padding:"0.75rem 0.5rem",textAlign:"center",fontWeight:"600",width:"100px"},children:"Photos"})]})}),(0,t.jsx)("tbody",{children:p.map(e=>(0,t.jsxs)("tr",{style:{borderBottom:"1px solid #eee",backgroundColor:s.includes(e.ID)?"#e3f2fd":"transparent",cursor:"pointer"},onClick:()=>F(e.ID),children:[(0,t.jsx)("td",{style:{padding:"0.75rem 0.5rem",textAlign:"center"},children:(0,t.jsx)("input",{type:"checkbox",checked:s.includes(e.ID),onChange:()=>F(e.ID),disabled:!s.includes(e.ID)&&s.length>=5,style:{cursor:"pointer"},onClick:e=>e.stopPropagation()})}),(0,t.jsx)("td",{style:{padding:"0.75rem 0.5rem",fontWeight:"500",color:"#212529"},children:e.neName}),(0,t.jsx)("td",{style:{padding:"0.75rem 0.5rem",color:"#6c757d",fontSize:"0.9rem"},children:e.neRelation||"—"}),(0,t.jsx)("td",{style:{padding:"0.75rem 0.5rem",textAlign:"center",fontWeight:"500",color:"#495057"},children:e.neCount})]},e.ID))})]})})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Or Select an Event:"}),(0,t.jsxs)("select",{value:a||"",onChange:e=>c(e.target.value?parseInt(e.target.value):null),children:[(0,t.jsx)("option",{value:"",children:"-- Select Event --"}),j.map(e=>(0,t.jsxs)("option",{value:e.ID,children:[e.neName," (",e.neCount," photos)"]},e.ID))]})]}),(0,t.jsx)("div",{className:"form-group",style:{padding:"0.75rem",backgroundColor:"#f8f9fa",borderRadius:"4px",border:"1px solid #dee2e6"},children:(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",margin:0,fontSize:"0.95rem"},children:[(0,t.jsx)("input",{type:"checkbox",checked:l,onChange:e=>d(e.target.checked),style:{marginRight:"0.75rem",cursor:"pointer"}}),(0,t.jsx)("span",{children:"Show photos with no people tagged"})]})}),s.length>1&&(0,t.jsx)("div",{className:"form-group",style:{padding:"0.75rem",backgroundColor:"#fff3cd",borderRadius:"4px",border:"1px solid #ffc107"},children:(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",margin:0,fontSize:"0.95rem"},children:[(0,t.jsx)("input",{type:"checkbox",checked:i,onChange:e=>m(e.target.checked),style:{marginRight:"0.75rem",cursor:"pointer"}}),(0,t.jsxs)("span",{children:["Show only photos with ",(0,t.jsx)("strong",{children:"ALL"})," selected people (AND logic)"]})]})}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Sort Order:"}),(0,t.jsxs)("select",{value:r,onChange:e=>h(e.target.value),children:[(0,t.jsx)("option",{value:"desc",children:"Newest to Oldest"}),(0,t.jsx)("option",{value:"asc",children:"Oldest to Newest"})]})]}),(0,t.jsxs)("div",{className:"flex flex-gap mt-2",children:[(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>{o([]),c(null),d(!1)},children:"Clear Selection"}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:u,disabled:0===s.length&&!a&&!l,children:"Continue to Gallery"})]})]})}function i(e){let{peopleIds:s,eventId:a,noPeople:l,sortOrder:r,exclusiveFilter:i,onMediaClick:o}=e,[c,d]=(0,n.useState)([]),[h,m]=(0,n.useState)(!0),[u,p]=(0,n.useState)(null),[x,j]=(0,n.useState)(0),[g,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{N()},[s,a,l,r,i]);let N=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{m(!0),p(null),e&&0===x&&v(!0);let t=new URLSearchParams;s.length>0&&(t.append("peopleIds",s.join(",")),i&&t.append("exclusiveFilter","true")),a&&t.append("eventId",a.toString()),l&&t.append("noPeople","true"),t.append("sortOrder",r);let n=new AbortController,o=setTimeout(()=>n.abort(),6e4),c=await fetch("/api/media?".concat(t.toString()),{signal:n.signal});if(clearTimeout(o),!c.ok){let e=await c.json().catch(()=>({error:"Unknown error"}));throw e.message,e.stack,e.debug,Error(e.message||e.error||"Server error: ".concat(c.status))}let h=await c.json();h.filter(e=>2===e.PType).length,d(h),j(0),v(!1)}catch(e){e instanceof Error?"AbortError"===e.name?p("The request timed out. The database may be warming up. Please try again."):p(e.message):p("An error occurred")}finally{m(!1)}};return h?(0,t.jsx)("div",{className:"loading-container",children:(0,t.jsxs)("div",{className:"loading-card",children:[(0,t.jsx)("div",{className:"loading-spinner"}),g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"mt-2",children:"Waking up the database..."}),(0,t.jsx)("p",{className:"loading-message",children:"The database is starting up. This may take a moment on the first request."}),(0,t.jsx)("div",{className:"loading-progress",children:(0,t.jsx)("div",{className:"loading-progress-bar"})}),(0,t.jsx)("p",{className:"loading-hint",children:"Please wait, this usually takes 10-30 seconds..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"mt-2",children:"Loading your photos..."}),(0,t.jsx)("p",{className:"loading-message",children:"Fetching media from the database"})]})]})}):u?(0,t.jsx)("div",{className:"error-container",children:(0,t.jsxs)("div",{className:"error-card",children:[(0,t.jsx)("div",{className:"error-icon",children:"⚠️"}),(0,t.jsx)("h2",{children:"Unable to Load Photos"}),(0,t.jsx)("p",{className:"error-message",children:u}),u.includes("warming up")||u.includes("timed out")?(0,t.jsxs)("div",{className:"error-hint",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"\uD83D\uDCA1 Tip:"})," The database may need a moment to start up."]}),(0,t.jsx)("p",{children:"Click retry below - it should work on the second try!"})]}):null,(0,t.jsxs)("button",{className:"btn btn-primary mt-2",onClick:()=>{j(e=>e+1),N(!0)},children:["\uD83D\uDD04 Retry ",x>0&&"(Attempt ".concat(x+1,")")]})]})}):0===c.length?(0,t.jsxs)("div",{className:"card text-center",children:[(0,t.jsx)("h2",{children:"No Photos Found"}),(0,t.jsx)("p",{children:"No photos match your selected criteria."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"card mb-2",children:(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:c.length})," photo",1!==c.length?"s":""," found"]})}),(0,t.jsx)("div",{className:"thumbnail-gallery",children:c.map(e=>(0,t.jsxs)("div",{className:"thumbnail-item ".concat(2===e.PType?"video-thumbnail":""),onClick:()=>o(e),children:[(0,t.jsx)("img",{src:e.PThumbnailUrl||"/placeholder.svg",alt:e.PDescription||e.PFileName,onError:e=>{e.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200"%3E%3Crect width="200" height="200" fill="%23ddd"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999" font-family="sans-serif"%3ENo Thumbnail%3C/text%3E%3C/svg%3E'}}),2===e.PType&&(0,t.jsx)("div",{className:"video-indicator",children:e.PTime?"".concat(Math.floor(e.PTime/60),":").concat((e.PTime%60).toString().padStart(2,"0")):"VIDEO"})]},e.PFileName))})]})}function o(e){var s;let{media:a,onClose:l,onUpdate:r}=e,[i,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[h,m]=(0,n.useState)(a.PDescription||""),[u,p]=(0,n.useState)(a.PMonth||""),[x,j]=(0,n.useState)(a.PYear||""),[g,v]=(0,n.useState)(""),[N,b]=(0,n.useState)(a.TaggedPeople||[]),[f,y]=(0,n.useState)([]),[w,C]=(0,n.useState)([]),[S,k]=(0,n.useState)(!1),[D,E]=(0,n.useState)(!1),[P,T]=(0,n.useState)(!1),[F,I]=(0,n.useState)(!1),[U,A]=(0,n.useState)(!1),[R,O]=(0,n.useState)(!1),[L,B]=(0,n.useState)(""),[M,J]=(0,n.useState)(""),[W,Y]=(0,n.useState)(""),[z,_]=(0,n.useState)(""),[H,V]=(0,n.useState)(!1),[q,G]=(0,n.useState)(!1);(0,n.useEffect)(()=>{i&&0===w.length&&K()},[i]),(0,n.useEffect)(()=>{S&&0===f.length&&Q()},[S]);let Q=async()=>{try{E(!0);let e=await fetch("/api/people");if(!e.ok){let s=await e.json().catch(()=>({error:"Unknown error"}));throw Error(s.message||"Failed to fetch people")}let s=await e.json();y(s)}catch(e){alert("Failed to load people list")}finally{E(!1)}},K=async()=>{try{T(!0);let e=await fetch("/api/events");if(!e.ok){let s=await e.json().catch(()=>({error:"Unknown error"}));throw Error(s.message||"Failed to fetch events")}let s=await e.json();s.success&&C(s.events)}catch(e){alert("Failed to load events list")}finally{T(!1)}},X=async e=>{if(N.some(s=>s.ID===e)){alert("This person is already tagged in this photo");return}try{I(!0);let s=await fetch("/api/media/".concat(encodeURIComponent(a.PFileName),"/tags"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({personId:e,position:0})});if(!s.ok){let e=await s.json().catch(()=>({error:"Unknown error"}));throw Error(e.message||"Failed to tag person")}let t=f.find(s=>s.ID===e);if(t){let e=[...N,{ID:t.ID,neName:t.neName}];b(e),r&&r({...a,TaggedPeople:e})}k(!1)}catch(e){alert("Failed to tag person")}finally{I(!1)}},Z=async e=>{if(confirm("Remove this person tag?"))try{let s=await fetch("/api/media/".concat(encodeURIComponent(a.PFileName),"/tags/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({personId:e})});if(!s.ok){let e=await s.json().catch(()=>({error:"Unknown error"}));throw Error(e.message||"Failed to remove person tag")}let t=N.filter(s=>s.ID!==e);b(t),r&&r({...a,TaggedPeople:t})}catch(e){alert("Failed to remove person tag")}},$=async()=>{try{let e=await fetch("/api/media/".concat(encodeURIComponent(a.PFileName)),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:h,month:u||null,year:x||null,eventID:g||null})});if(!e.ok){let s=await e.json().catch(()=>({error:"Unknown error"}));throw Error(s.message||"Failed to update media")}let s=await e.json();s.success&&r&&r({...a,...s.media,TaggedPeople:N}),o(!1),alert("Successfully updated!")}catch(e){alert("Failed to update media")}},ee=async()=>{if(!L.trim()){alert("Please enter a name");return}try{V(!0);let e=await fetch("/api/people",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({neName:L.trim(),neRelation:M.trim()||null})});if(!e.ok){let s=await e.json().catch(()=>({error:"Unknown error"}));throw Error(s.message||"Failed to create person")}let s=await e.json();if(s.success&&s.person){let e={...s.person,neCount:0};y([...f,e].sort((e,s)=>e.neName.localeCompare(s.neName))),await X(s.person.ID),B(""),J(""),A(!1)}}catch(e){alert("Failed to create person")}finally{V(!1)}},es=async()=>{if(!W.trim()){alert("Please enter an event name");return}try{G(!0);let e=await fetch("/api/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({neName:W.trim(),neRelation:z.trim()||null})});if(!e.ok){let s=await e.json().catch(()=>({error:"Unknown error"}));throw Error(s.message||"Failed to create event")}let s=await e.json();if(s.success&&s.event){let e={...s.event,neCount:0};C([...w,e].sort((e,s)=>e.neName.localeCompare(s.neName))),v(s.event.ID),Y(""),_(""),O(!1)}}catch(e){alert("Failed to create event")}finally{G(!1)}};return(0,t.jsxs)(t.Fragment,{children:[c&&(0,t.jsxs)("div",{className:"fullscreen-overlay",onClick:()=>d(!1),children:[(0,t.jsx)("button",{onClick:()=>d(!1),className:"fullscreen-close",children:"✕"}),1===a.PType?(0,t.jsx)("img",{src:a.PBlobUrl,alt:a.PDescription||a.PFileName,className:"fullscreen-image"}):(0,t.jsx)("video",{controls:!0,src:a.PBlobUrl,className:"fullscreen-video",autoPlay:!0,children:"Your browser does not support the video tag."})]}),(0,t.jsx)("div",{className:"modal-overlay",onClick:l,children:(0,t.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:l,style:{position:"absolute",top:"1rem",right:"1rem",background:"none",border:"none",fontSize:"2rem",cursor:"pointer",zIndex:10},children:"\xd7"}),(0,t.jsxs)("div",{className:"detail-view",children:[(0,t.jsx)("div",{className:"media-display",children:1===a.PType?(0,t.jsx)("img",{src:a.PBlobUrl,alt:a.PDescription||a.PFileName,onClick:()=>d(!0),style:{cursor:"pointer"}}):(0,t.jsx)("video",{controls:!0,src:a.PBlobUrl,onClick:()=>d(!0),style:{cursor:"pointer"},children:"Your browser does not support the video tag."})}),(0,t.jsxs)("div",{className:"metadata-panel",children:[(0,t.jsx)("h2",{style:{marginTop:0},children:a.PFileName}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Dimensions:"})," ",a.PWidth," x ",a.PHeight]}),2===a.PType&&a.PTime&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Duration:"})," ",Math.floor(a.PTime/60),":",(a.PTime%60).toString().padStart(2,"0")]}),(0,t.jsxs)("div",{className:"form-group mt-2",children:[(0,t.jsx)("label",{children:"Date:"}),i?(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,t.jsxs)("select",{value:u,onChange:e=>p(e.target.value?parseInt(e.target.value):""),children:[(0,t.jsx)("option",{value:"",children:"Month"}),Array.from({length:12},(e,s)=>s+1).map(e=>(0,t.jsx)("option",{value:e,children:new Date(2e3,e-1).toLocaleString("default",{month:"long"})},e))]}),(0,t.jsx)("input",{type:"number",value:x,onChange:e=>j(e.target.value?parseInt(e.target.value):""),placeholder:"Year",style:{width:"100px"}})]}):(0,t.jsx)("p",{children:u&&x?"".concat(new Date(2e3,u-1).toLocaleString("default",{month:"long"})," ").concat(x):"Not set"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Description:"}),i?(0,t.jsx)("textarea",{value:h,onChange:e=>m(e.target.value),rows:4}):(0,t.jsx)("p",{children:h||"No description"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Event:"}),i?P?(0,t.jsx)("div",{className:"loading-spinner"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,t.jsxs)("select",{value:g,onChange:e=>v(e.target.value?parseInt(e.target.value):""),style:{flex:1},children:[(0,t.jsx)("option",{value:"",children:"-- No Event --"}),w.map(e=>(0,t.jsxs)("option",{value:e.ID,children:[e.neName," (",e.neCount," photos)"]},e.ID))]}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>O(!0),title:"Create new event",children:"+ New"})]}),R&&(0,t.jsxs)("div",{className:"inline-create-form",children:[(0,t.jsx)("h4",{children:"Create New Event"}),(0,t.jsx)("input",{type:"text",placeholder:"Event name",value:W,onChange:e=>Y(e.target.value),autoFocus:!0}),(0,t.jsx)("textarea",{placeholder:"Event details (optional)",value:z,onChange:e=>_(e.target.value),rows:2}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[(0,t.jsx)("button",{className:"btn btn-success btn-sm",onClick:es,disabled:q||!W.trim(),children:q?"Creating...":"Create & Select"}),(0,t.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>{O(!1),Y(""),_("")},disabled:q,children:"Cancel"})]})]})]}):(0,t.jsx)("p",{children:g&&(null===(s=w.find(e=>e.ID===g))||void 0===s?void 0:s.neName)||"Not set"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Tagged People:"}),N.length>0?(0,t.jsx)("div",{className:"tagged-people-list",children:N.map(e=>(0,t.jsxs)("div",{className:"tagged-person-item",children:[(0,t.jsx)("span",{children:e.neName}),i&&(0,t.jsx)("button",{onClick:()=>Z(e.ID),className:"btn-remove-tag",title:"Remove tag",children:"✕"})]},e.ID))}):(0,t.jsx)("p",{children:"No one tagged yet"}),i&&(0,t.jsx)(t.Fragment,{children:S?(0,t.jsxs)("div",{className:"people-selector-dropdown",children:[(0,t.jsxs)("div",{className:"flex flex-between mb-1",children:[(0,t.jsx)("strong",{children:"Select a person:"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,t.jsx)("button",{className:"btn btn-success btn-sm",onClick:()=>A(!0),title:"Create new person",children:"+ New"}),(0,t.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>k(!1),children:"Cancel"})]})]}),U&&(0,t.jsxs)("div",{className:"inline-create-form",style:{marginBottom:"1rem"},children:[(0,t.jsx)("h4",{children:"Create New Person"}),(0,t.jsx)("input",{type:"text",placeholder:"Full name",value:L,onChange:e=>B(e.target.value),autoFocus:!0}),(0,t.jsx)("input",{type:"text",placeholder:"Relationship (e.g., Uncle, Cousin)",value:M,onChange:e=>J(e.target.value)}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[(0,t.jsx)("button",{className:"btn btn-success btn-sm",onClick:ee,disabled:H||!L.trim(),children:H?"Creating...":"Create & Tag"}),(0,t.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>{A(!1),B(""),J("")},disabled:H,children:"Cancel"})]})]}),D?(0,t.jsx)("div",{className:"loading-spinner"}):(0,t.jsxs)("div",{className:"people-list-scroll",children:[f.filter(e=>!N.some(s=>s.ID===e.ID)).map(e=>(0,t.jsxs)("button",{className:"person-list-item",onClick:()=>X(e.ID),disabled:F,children:[e.neName,e.neRelation&&(0,t.jsxs)("span",{className:"person-relation",children:[" - ",e.neRelation]}),e.neCount>0&&(0,t.jsxs)("span",{className:"person-count",children:[" (",e.neCount," photos)"]})]},e.ID)),0===f.filter(e=>!N.some(s=>s.ID===e.ID)).length&&(0,t.jsx)("p",{className:"text-center",style:{padding:"1rem",color:"#6c757d"},children:"All people are already tagged"})]})]}):(0,t.jsx)("button",{className:"btn btn-secondary mt-1",onClick:()=>k(!0),style:{width:"100%"},children:"+ Add Person"})})]}),(0,t.jsx)("div",{className:"flex flex-gap mt-2",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"btn btn-success",onClick:$,children:"Save"}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>o(!1),children:"Cancel"})]}):(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>o(!0),children:"Edit"})})]})]})]})})]})}function c(){let[e,s]=(0,n.useState)([]),[a,l]=(0,n.useState)(!0),[r,i]=(0,n.useState)(null),[o,c]=(0,n.useState)(""),[d,h]=(0,n.useState)(null),[m,u]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[j,g]=(0,n.useState)("");(0,n.useEffect)(()=>{v()},[]);let v=async()=>{try{l(!0),i(null);let e=await fetch("/api/people");if(!e.ok)throw Error("Failed to fetch people");let a=await e.json();s(a)}catch(e){i(e instanceof Error?e.message:"An error occurred")}finally{l(!1)}},N=async()=>{if(!p.trim()){alert("Please enter a name");return}try{if(!(await fetch("/api/people",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:p,relation:j})})).ok)throw Error("Failed to create person");await v(),u(!1),x(""),g("")}catch(e){alert("Error creating person: "+(e instanceof Error?e.message:"Unknown error"))}},b=async()=>{if(!d||!p.trim()){alert("Please enter a name");return}try{if(!(await fetch("/api/people",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:d.ID,name:p,relation:j})})).ok)throw Error("Failed to update person");await v(),h(null),x(""),g("")}catch(e){alert("Error updating person: "+(e instanceof Error?e.message:"Unknown error"))}},f=async e=>{if(confirm("Delete ".concat(e.neName,"? This will remove them from all photos.")))try{if(!(await fetch("/api/people",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.ID})})).ok)throw Error("Failed to delete person");await v()}catch(e){alert("Error deleting person: "+(e instanceof Error?e.message:"Unknown error"))}},y=e=>{h(e),x(e.neName),g(e.neRelation||""),u(!1)},w=e.filter(e=>e.neName.toLowerCase().includes(o.toLowerCase()));return a?(0,t.jsx)("div",{className:"loading-container",children:(0,t.jsxs)("div",{className:"loading-card",children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsx)("h3",{className:"mt-2",children:"Loading people..."})]})}):r?(0,t.jsx)("div",{className:"error-container",children:(0,t.jsxs)("div",{className:"error-card",children:[(0,t.jsx)("div",{className:"error-icon",children:"⚠️"}),(0,t.jsx)("h2",{children:"Unable to Load People"}),(0,t.jsx)("p",{className:"error-message",children:r}),(0,t.jsx)("button",{className:"btn btn-primary mt-2",onClick:v,children:"\uD83D\uDD04 Retry"})]})}):(0,t.jsxs)("div",{className:"manager-container",children:[(0,t.jsxs)("div",{className:"manager-header",children:[(0,t.jsx)("h1",{children:"\uD83D\uDC65 People Manager"}),(0,t.jsx)("p",{className:"manager-subtitle",children:"Manage family members and friends"})]}),(0,t.jsxs)("div",{className:"manager-toolbar",children:[(0,t.jsx)("input",{type:"text",placeholder:"\uD83D\uDD0D Search by name...",value:o,onChange:e=>c(e.target.value),className:"search-input"}),(0,t.jsx)("button",{className:"btn btn-success",onClick:()=>{u(!0),h(null),x(""),g("")},children:"➕ Add New Person"})]}),(m||d)&&(0,t.jsxs)("div",{className:"manager-form-card",children:[(0,t.jsx)("h3",{children:m?"Add New Person":"Edit ".concat(null==d?void 0:d.neName)}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Name *"}),(0,t.jsx)("input",{type:"text",value:p,onChange:e=>x(e.target.value),placeholder:"Full name",autoFocus:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Relationship"}),(0,t.jsx)("input",{type:"text",value:j,onChange:e=>g(e.target.value),placeholder:"e.g., Grandmother, Uncle, Friend"})]}),(0,t.jsxs)("div",{className:"flex flex-gap mt-2",children:[m?(0,t.jsx)("button",{className:"btn btn-success",onClick:N,children:"✓ Create"}):(0,t.jsx)("button",{className:"btn btn-success",onClick:b,children:"✓ Save Changes"}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>{u(!1),h(null),x(""),g("")},children:"Cancel"})]})]}),(0,t.jsxs)("div",{className:"manager-list-card",children:[(0,t.jsxs)("div",{className:"manager-stats",children:[(0,t.jsx)("strong",{children:w.length})," ",1===w.length?"person":"people",o&&' matching "'.concat(o,'"')]}),0===w.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("p",{children:"No people found."}),o&&(0,t.jsx)("p",{className:"text-muted",children:"Try adjusting your search."})]}):(0,t.jsx)("div",{className:"manager-table-container",children:(0,t.jsxs)("table",{className:"manager-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Name"}),(0,t.jsx)("th",{children:"Relationship"}),(0,t.jsx)("th",{children:"Photos"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:w.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"name-cell",children:e.neName}),(0,t.jsx)("td",{className:"relation-cell",children:e.neRelation||"—"}),(0,t.jsx)("td",{className:"count-cell",children:e.neCount||0}),(0,t.jsxs)("td",{className:"actions-cell",children:[(0,t.jsx)("button",{className:"btn-icon btn-edit",onClick:()=>y(e),title:"Edit",children:"✏️"}),(0,t.jsx)("button",{className:"btn-icon btn-delete",onClick:()=>f(e),title:"Delete",children:"\uD83D\uDDD1️"})]})]},e.ID))})]})})]})]})}function d(){let[e,s]=(0,n.useState)([]),[a,l]=(0,n.useState)(!0),[r,i]=(0,n.useState)(null),[o,c]=(0,n.useState)(""),[d,h]=(0,n.useState)(null),[m,u]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[j,g]=(0,n.useState)("");(0,n.useEffect)(()=>{v()},[]);let v=async()=>{try{l(!0),i(null);let e=await fetch("/api/events");if(!e.ok)throw Error("Failed to fetch events");let a=await e.json();s(a)}catch(e){i(e instanceof Error?e.message:"An error occurred")}finally{l(!1)}},N=async()=>{if(!p.trim()){alert("Please enter an event name");return}try{if(!(await fetch("/api/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:p,details:j})})).ok)throw Error("Failed to create event");await v(),u(!1),x(""),g("")}catch(e){alert("Error creating event: "+(e instanceof Error?e.message:"Unknown error"))}},b=async()=>{if(!d||!p.trim()){alert("Please enter an event name");return}try{if(!(await fetch("/api/events",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:d.ID,name:p,details:j})})).ok)throw Error("Failed to update event");await v(),h(null),x(""),g("")}catch(e){alert("Error updating event: "+(e instanceof Error?e.message:"Unknown error"))}},f=async e=>{if(confirm('Delete event "'.concat(e.neName,'"? This will remove it from all photos.')))try{if(!(await fetch("/api/events",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.ID})})).ok)throw Error("Failed to delete event");await v()}catch(e){alert("Error deleting event: "+(e instanceof Error?e.message:"Unknown error"))}},y=e=>{h(e),x(e.neName),g(e.neRelation||""),u(!1)},w=e.filter(e=>e.neName.toLowerCase().includes(o.toLowerCase()));return a?(0,t.jsx)("div",{className:"loading-container",children:(0,t.jsxs)("div",{className:"loading-card",children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsx)("h3",{className:"mt-2",children:"Loading events..."})]})}):r?(0,t.jsx)("div",{className:"error-container",children:(0,t.jsxs)("div",{className:"error-card",children:[(0,t.jsx)("div",{className:"error-icon",children:"⚠️"}),(0,t.jsx)("h2",{children:"Unable to Load Events"}),(0,t.jsx)("p",{className:"error-message",children:r}),(0,t.jsx)("button",{className:"btn btn-primary mt-2",onClick:v,children:"\uD83D\uDD04 Retry"})]})}):(0,t.jsxs)("div",{className:"manager-container",children:[(0,t.jsxs)("div",{className:"manager-header",children:[(0,t.jsx)("h1",{children:"\uD83D\uDCC5 Event Manager"}),(0,t.jsx)("p",{className:"manager-subtitle",children:"Manage family events, weddings, reunions, and more"})]}),(0,t.jsxs)("div",{className:"manager-toolbar",children:[(0,t.jsx)("input",{type:"text",placeholder:"\uD83D\uDD0D Search events...",value:o,onChange:e=>c(e.target.value),className:"search-input"}),(0,t.jsx)("button",{className:"btn btn-success",onClick:()=>{u(!0),h(null),x(""),g("")},children:"➕ Add New Event"})]}),(m||d)&&(0,t.jsxs)("div",{className:"manager-form-card",children:[(0,t.jsx)("h3",{children:m?"Add New Event":"Edit ".concat(null==d?void 0:d.neName)}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Event Name *"}),(0,t.jsx)("input",{type:"text",value:p,onChange:e=>x(e.target.value),placeholder:"e.g., Sarah's Wedding, Summer Reunion 2024",autoFocus:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Event Details"}),(0,t.jsx)("textarea",{value:j,onChange:e=>g(e.target.value),placeholder:"Additional information about the event...",rows:3})]}),(0,t.jsxs)("div",{className:"flex flex-gap mt-2",children:[m?(0,t.jsx)("button",{className:"btn btn-success",onClick:N,children:"✓ Create"}):(0,t.jsx)("button",{className:"btn btn-success",onClick:b,children:"✓ Save Changes"}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>{u(!1),h(null),x(""),g("")},children:"Cancel"})]})]}),(0,t.jsxs)("div",{className:"manager-list-card",children:[(0,t.jsxs)("div",{className:"manager-stats",children:[(0,t.jsx)("strong",{children:w.length})," ",1===w.length?"event":"events",o&&' matching "'.concat(o,'"')]}),0===w.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("p",{children:"No events found."}),o&&(0,t.jsx)("p",{className:"text-muted",children:"Try adjusting your search."})]}):(0,t.jsx)("div",{className:"manager-table-container",children:(0,t.jsxs)("table",{className:"manager-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Event Name"}),(0,t.jsx)("th",{children:"Details"}),(0,t.jsx)("th",{children:"Photos"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:w.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"name-cell",children:e.neName}),(0,t.jsx)("td",{className:"relation-cell",children:e.neRelation?(0,t.jsx)("span",{className:"event-details-preview",children:e.neRelation.length>100?e.neRelation.substring(0,100)+"...":e.neRelation}):"—"}),(0,t.jsx)("td",{className:"count-cell",children:e.neCount||0}),(0,t.jsxs)("td",{className:"actions-cell",children:[(0,t.jsx)("button",{className:"btn-icon btn-edit",onClick:()=>y(e),title:"Edit",children:"✏️"}),(0,t.jsx)("button",{className:"btn-icon btn-delete",onClick:()=>f(e),title:"Delete",children:"\uD83D\uDDD1️"})]})]},e.ID))})]})})]})]})}function h(){let[e,s]=(0,n.useState)(null),[a,l]=(0,n.useState)(0),[r,i]=(0,n.useState)(!0),[o,c]=(0,n.useState)(""),[d,h]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),[p,x]=(0,n.useState)(""),[j,g]=(0,n.useState)(""),[v,N]=(0,n.useState)(""),[b,f]=(0,n.useState)([]),[y,w]=(0,n.useState)([]),[C,S]=(0,n.useState)([]),[k,D]=(0,n.useState)(!1),[E,P]=(0,n.useState)(!1);(0,n.useEffect)(()=>{T(),F()},[]),(0,n.useEffect)(()=>{I(),U()},[]);let T=async()=>{D(!0);try{let e=await fetch("/api/people"),s=await e.json();s.success&&w(s.people)}catch(e){}finally{D(!1)}},F=async()=>{P(!0);try{let e=await fetch("/api/events"),s=await e.json();s.success&&S(s.events)}catch(e){}finally{P(!1)}},I=async()=>{i(!0),c("");try{let e=await fetch("/api/unindexed/next"),a=await e.json();a.success?a.file?(s(a.file),u(""),x(""),g(""),N(""),f([])):s(null):c(a.error||"Failed to load file")}catch(e){c(e.message||"Failed to load file")}finally{i(!1)}},U=async()=>{try{let e=await fetch("/api/unindexed/count"),s=await e.json();s.success&&l(s.count)}catch(e){}},A=async()=>{if(e){h(!0),c("");try{let s=await fetch("/api/unindexed/process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uiID:e.uiID,fileName:e.uiFileName,directory:e.uiDirectory,description:m,month:p||null,year:j||null,eventID:v||null,people:b,blobUrl:e.uiBlobUrl,thumbUrl:e.uiThumbUrl,type:e.uiType,width:e.uiWidth,height:e.uiHeight,vtime:e.uiVtime})}),a=await s.json();a.success?(await I(),await U()):c(a.error||"Failed to process file")}catch(e){c(e.message||"Failed to process file")}finally{h(!1)}}},R=async()=>{if(e&&confirm('Are you sure you want to delete "'.concat(e.uiFileName,'"? This cannot be undone.'))){h(!0),c("");try{let s=await fetch("/api/unindexed/".concat(e.uiID),{method:"DELETE"}),a=await s.json();a.success?(await I(),await U()):c(a.error||"Failed to delete file")}catch(e){c(e.message||"Failed to delete file")}finally{h(!1)}}},O=e=>{f(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return r?(0,t.jsx)("div",{className:"process-container",children:(0,t.jsxs)("div",{className:"loading-card",children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsx)("p",{children:"Loading unindexed files..."})]})}):e?(0,t.jsxs)("div",{className:"process-container",children:[(0,t.jsxs)("div",{className:"process-header",children:[(0,t.jsx)("h2",{children:"Process New Files"}),(0,t.jsxs)("div",{className:"process-count",children:[a," file",1!==a?"s":""," remaining"]})]}),o&&(0,t.jsxs)("div",{className:"error-banner",children:[(0,t.jsx)("span",{className:"error-icon",children:"⚠️"}),o]}),(0,t.jsxs)("div",{className:"process-layout",children:[(0,t.jsxs)("div",{className:"process-preview",children:[(0,t.jsxs)("div",{className:"preview-header",children:[(0,t.jsx)("h3",{children:"Preview"}),(0,t.jsxs)("div",{className:"file-info",children:[(0,t.jsxs)("div",{className:"info-row",children:[(0,t.jsx)("span",{className:"label",children:"File:"}),(0,t.jsx)("span",{className:"value",children:e.uiFileName})]}),(0,t.jsxs)("div",{className:"info-row",children:[(0,t.jsx)("span",{className:"label",children:"Dimensions:"}),(0,t.jsxs)("span",{className:"value",children:[e.uiWidth," \xd7 ",e.uiHeight]})]}),2===e.uiType&&e.uiVtime>0&&(0,t.jsxs)("div",{className:"info-row",children:[(0,t.jsx)("span",{className:"label",children:"Duration:"}),(0,t.jsxs)("span",{className:"value",children:[Math.floor(e.uiVtime/60),":",(e.uiVtime%60).toString().padStart(2,"0")]})]})]})]}),(0,t.jsx)("div",{className:"preview-content",children:1===e.uiType?(0,t.jsx)("img",{src:e.uiBlobUrl,alt:e.uiFileName,className:"preview-image"}):(0,t.jsx)("video",{src:e.uiBlobUrl,controls:!0,className:"preview-video"})})]}),(0,t.jsxs)("div",{className:"process-form",children:[(0,t.jsx)("h3",{children:"Add Metadata"}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Description"}),(0,t.jsx)("textarea",{value:m,onChange:e=>u(e.target.value),placeholder:"Enter a description...",rows:3,disabled:d})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Month"}),(0,t.jsxs)("select",{value:p,onChange:e=>x(e.target.value?parseInt(e.target.value):""),disabled:d,children:[(0,t.jsx)("option",{value:"",children:"-- Select --"}),(0,t.jsx)("option",{value:"1",children:"January"}),(0,t.jsx)("option",{value:"2",children:"February"}),(0,t.jsx)("option",{value:"3",children:"March"}),(0,t.jsx)("option",{value:"4",children:"April"}),(0,t.jsx)("option",{value:"5",children:"May"}),(0,t.jsx)("option",{value:"6",children:"June"}),(0,t.jsx)("option",{value:"7",children:"July"}),(0,t.jsx)("option",{value:"8",children:"August"}),(0,t.jsx)("option",{value:"9",children:"September"}),(0,t.jsx)("option",{value:"10",children:"October"}),(0,t.jsx)("option",{value:"11",children:"November"}),(0,t.jsx)("option",{value:"12",children:"December"})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Year"}),(0,t.jsx)("input",{type:"number",value:j,onChange:e=>g(e.target.value?parseInt(e.target.value):""),placeholder:"YYYY",min:"1900",max:"2100",disabled:d})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Event"}),(0,t.jsxs)("select",{value:v,onChange:e=>N(e.target.value?parseInt(e.target.value):""),disabled:d||E,children:[(0,t.jsx)("option",{value:"",children:"-- No Event --"}),C.map(e=>(0,t.jsxs)("option",{value:e.ID,children:[e.neName," (",e.neCount," photos)"]},e.ID))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Tag People"}),(0,t.jsx)("div",{className:"people-checkboxes",children:k?(0,t.jsx)("p",{className:"loading-text",children:"Loading people..."}):0===y.length?(0,t.jsx)("p",{className:"empty-text",children:"No people in database"}):y.map(e=>(0,t.jsxs)("label",{className:"checkbox-label",children:[(0,t.jsx)("input",{type:"checkbox",checked:b.includes(e.ID),onChange:()=>O(e.ID),disabled:d}),(0,t.jsx)("span",{className:"person-name",children:e.neName}),(0,t.jsxs)("span",{className:"person-relation",children:["(",e.neRelation,")"]})]},e.ID))})]}),(0,t.jsxs)("div",{className:"form-actions",children:[(0,t.jsx)("button",{onClick:A,disabled:d,className:"btn btn-primary",children:d?"Processing...":"Save & Next"}),(0,t.jsx)("button",{onClick:()=>{I()},disabled:d,className:"btn btn-secondary",children:"Skip"}),(0,t.jsx)("button",{onClick:R,disabled:d,className:"btn btn-danger",children:"Delete"})]})]})]})]}):(0,t.jsx)("div",{className:"process-container",children:(0,t.jsxs)("div",{className:"completion-card",children:[(0,t.jsx)("div",{className:"completion-icon",children:"✓"}),(0,t.jsx)("h2",{children:"All Files Processed!"}),(0,t.jsx)("p",{children:"There are no unindexed files remaining."}),(0,t.jsx)("p",{className:"completion-hint",children:"Upload new files to add them to the review queue."})]})})}function m(){let[e,s]=(0,n.useState)("select"),[a,m]=(0,n.useState)([]),[u,p]=(0,n.useState)(null),[x,j]=(0,n.useState)("desc"),[g,v]=(0,n.useState)(!1),[N,b]=(0,n.useState)(!1),[f,y]=(0,n.useState)(null);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l,{onManagePeople:()=>s("manage-people"),onManageEvents:()=>s("manage-events"),onSelectPeople:()=>s("select"),onProcessFiles:()=>s("process-files"),onBackup:()=>{alert("Backup functionality coming soon")}}),(0,t.jsxs)("main",{className:"container",children:["select"===e&&(0,t.jsx)(r,{selectedPeople:a,selectedEvent:u,showNoPeople:g,sortOrder:x,exclusiveFilter:N,onSelectedPeopleChange:m,onSelectedEventChange:p,onShowNoPeopleChange:v,onSortOrderChange:j,onExclusiveFilterChange:b,onContinue:()=>{s("gallery")}}),"gallery"===e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-between mb-2",children:[(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>{s("select"),y(null)},children:"← Back to Selection"}),(0,t.jsx)("div",{className:"flex flex-gap",children:(0,t.jsxs)("button",{className:"btn btn-secondary",onClick:()=>j("asc"===x?"desc":"asc"),children:["Sort: ","asc"===x?"Old to New":"New to Old"]})})]}),(0,t.jsx)(i,{peopleIds:a,eventId:u,noPeople:g,sortOrder:x,exclusiveFilter:N,onMediaClick:y})]}),"manage-people"===e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"btn btn-secondary mb-2",onClick:()=>s("select"),children:"← Back"}),(0,t.jsx)(c,{})]}),"manage-events"===e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"btn btn-secondary mb-2",onClick:()=>s("select"),children:"← Back"}),(0,t.jsx)(d,{})]}),"process-files"===e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"btn btn-secondary mb-2",onClick:()=>s("select"),children:"← Back"}),(0,t.jsx)(h,{})]}),f&&(0,t.jsx)(o,{media:f,onClose:()=>y(null)})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=1679)}),_N_E=e.O()}]);